/**
 * @version 1.0.0
 * @author fukuo <github.com/fukou>
 * @website https://fukuo.site
 */

var app={msnry:null,init:function(){app.headerToggleMenu(),app.headerToggleDarkMode(),app.headerSuggestion(),app.postSoundCloud(),app.postSpotify(),app.postBandCamp(),app.checkPhotoNPF(),app.masonry(),app.tinySlider(),app.loadTabs(),app.postNPF(),app.shortenPost(),app.postTags(),app.initCredit(),app.postNPFAudio(),app.postNPFData(),app.TOC(),app.sparkingEffect()},headerToggleMenu(){let e=document.querySelector(".btn-nav"),t=document.querySelector(".nav__additional");void 0!==e&&null!=e&&e.addEventListener("click",()=>{e.classList.toggle("is-actived"),t.classList.toggle("is-shown"),document.querySelector("body").classList.toggle("is-pushed")})},headerToggleDarkMode(){let e=document.querySelector(".btn-dark"),t=document.documentElement,o=()=>{let o="dark"===t.getAttribute("data-force-color-mode");o?(t.setAttribute("data-force-color-mode","light"),localStorage.setItem("color-mode","light"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><path d="M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4"></path></svg>'):(t.setAttribute("data-force-color-mode","dark"),localStorage.setItem("color-mode","dark"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>')};void 0!==e&&null!=e&&(e.addEventListener("click",o),e.innerHTML="dark"===colorModeOverride?'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><path d="M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4"></path></svg>')},headerSuggestion(){let e=document.querySelector(".nav__search"),t=document.getElementById("search"),o=document.querySelector(".nav__search__suggestion");void 0!==e&&null!=e&&(e.addEventListener("mousedown",()=>{t.focus()}),e.addEventListener("mouseup",()=>{o.style.display="block"}),document.addEventListener("mouseup",t=>{e.contains(t.target)||(o.style.display="none")}))},postNPF(){npfPhotosets(".posts",{includeCommonPhotosets:!0,useTumblrLightbox:!0,photosetMargins:"7.5"})},postSoundCloud(){let e=document.querySelectorAll(".soundcloud_audio_player");e&&e.forEach(function(e,t){let o=e.getAttribute("src").split("&")[0],r="&amp;liking=false&amp;sharing=false&amp;auto_play=false&amp;show_comments=false&amp;continuous_play=false&amp;buying=false&amp;show_playcount=false&amp;show_artwork=true&amp;origin=tumblr&amp;color="+"#de8100".split("#")[1];e.setAttribute("src",o+r),e.setAttribute("height",116),e.parentElement.classList.add("is-soundcloud")})},postSpotify(){let e=document.querySelectorAll(".spotify_audio_player");e&&e.forEach(function(e,t){e.parentElement.classList.add("is-spotify")})},postBandCamp(){let e=document.querySelectorAll(".bandcamp_audio_player");if(e)for(b of e)b.parentElement.classList.add("is-bandcamp")},checkPhotoNPF(){let e=document.querySelectorAll(".posts");e.forEach(function(e,t){let o=e.querySelector(".npf_photoset"),r=e.querySelector(".reblog-list figure.tmblr-full:first-of-type");o?e.classList.add("posts-photoset-text"):r&&e.classList.add("posts-photo-text")})},npfToLegacy(){document.querySelectorAll(".posts-photo-text").forEach(function(e,t){let o=e.querySelector(".posts__body .reblog-list:first-of-type > .npf_photoset"),r=e.querySelector(".posts__body .reblog-list:first-of-type > figure.tmblr-full");if(o){let a=o.cloneNode(!0);e.querySelector(".posts__media").append(a),o.parentElement.remove()}else if(r){let l=r.cloneNode(!0);e.querySelector(".posts__media").append(l),r.parentElement.remove()}})},masonry(){let e=document.querySelector("body[data-blog-style='masonry'] .wrapper__blog");if(void 0!==e&&null!=e){let t=document.createElement("div");t.classList.add("grid-loader"),t.textContent="Loading posts...",document.querySelector(".wrapper__blog").prepend(t),app.msnry=new Masonry(e,{itemSelector:"article.posts",columnWidth:".grid-sizer",horizontalOrder:!0,gutter:30,percentPosition:!0}),imagesLoaded(e).on("progress",function(){app.msnry.layout()}),imagesLoaded(e).on("done",function(){let e=document.querySelector(".grid-loader");e&&e.remove();let t=document.querySelectorAll("article.posts");t.forEach((e,t)=>{setTimeout(()=>{e.classList.add("load")},250*t)})})}},tinySlider(){var e=".slideshow";void 0!==e&&null!=e&&document.querySelectorAll(e).forEach(e=>{var t,o=e,r=o.getAttribute("data-mode")?o.getAttribute("data-mode"):"carousel",a=o.getAttribute("data-axis")?o.getAttribute("data-axis"):"horizontal",l=o.getAttribute("data-gutter")?o.getAttribute("data-gutter"):30,s=o.getAttribute("data-edge")?o.getAttribute("data-edge"):0,i=o.getAttribute("data-items")?o.getAttribute("data-items"):4,n=o.getAttribute("data-items-xl")?o.getAttribute("data-items-xl"):Number(i),d=o.getAttribute("data-items-lg")?o.getAttribute("data-items-lg"):Number(n),p=o.getAttribute("data-items-md")?o.getAttribute("data-items-md"):Number(d),c=o.getAttribute("data-items-sm")?o.getAttribute("data-items-sm"):Number(p),u=o.getAttribute("data-items-xs")?o.getAttribute("data-items-xs"):Number(c),g=o.getAttribute("data-speed")?o.getAttribute("data-speed"):500,h="true"===o.getAttribute("data-autowidth"),m="false"!==o.getAttribute("data-arrow"),y="false"!==o.getAttribute("data-dots"),_="false"!==o.getAttribute("data-autoplay"),f=o.getAttribute("data-autoplaytime")?o.getAttribute("data-autoplaytime"):4e3,$="true"===o.getAttribute("data-hoverpause"),v="false"!==o.getAttribute("data-loop"),w="true"===o.getAttribute("data-rewind"),x="true"===o.getAttribute("data-autoheight"),k="true"===o.getAttribute("data-fixedwidth"),A="false"!==o.getAttribute("data-touch"),S="false"!==o.getAttribute("data-drag"),E=o.getAttribute("data-slide-by")?o.getAttribute("data-slide-by"):"page",L=o.getAttribute("data-controls-container")?o.getAttribute("data-controls-container"):"";"rtl"===document.getElementsByTagName("html")[0].getAttribute("dir")&&(t="rtl"),tns({container:e,mode:r,axis:a,gutter:l,edgePadding:s,speed:g,autoWidth:h,controls:m,nav:y,autoplay:_,autoplayTimeout:f,autoplayHoverPause:$,autoplayButton:!1,autoplayButtonOutput:!1,controlsPosition:top,navPosition:top,autoplayPosition:top,controlsContainer:L,controlsText:['<i class="las la-angle-left"></i>','<i class="las la-angle-right"></i>',],loop:v,rewind:w,autoHeight:x,fixedWidth:k,touch:A,mouseDrag:S,arrowKeys:!0,items:i,textDirection:t,responsive:{0:{items:Number(u)},576:{items:Number(c),slideBy:"page"},768:{items:Number(p),slideBy:"page"},992:{items:Number(d),slideBy:"page"},1200:{items:Number(n),slideBy:E}}})})},loadTabs(){let e=document.querySelector("[data-tabs");void 0!==e&&null!=e&&new Tabby("[data-tabs]")},shortenPost(){document.querySelector("body.is-shorten-long-post")&&document.querySelectorAll("article[class*='long_post']").forEach(function(e){let t=e.querySelector(".posts__body");if(null!=t&&t.clientHeight>=700){t.classList.add("is-truncated");let o=document.createElement("a");o.className="is-toggle btn btn__primary",o.textContent="Expand",o.href="#",t.append(o),o.addEventListener("click",function(e){e.preventDefault(),t.classList.remove("is-truncated"),t.classList.add("is-truncated--full"),this.remove()})}})},postTags(){let e=document.querySelectorAll(".posts__bottom"),t=!1;e.forEach((e,o)=>{let r=e.querySelector(".posts__bottom__tags-btn"),a=e.querySelector(".posts__bottom__tags > ul");r?.addEventListener("click",function(e){e.preventDefault(),this.classList.toggle("is-active"),a.classList.toggle("is-shown"),a.classList.contains("is-shown")?(setTimeout(()=>{app.msnry.layout()},100),t=!0):(t=!1,app.msnry.layout())})}),document.addEventListener("transitionend",function(e){let o=e.target;o.classList.contains("posts__bottom__tags")&&!t?setTimeout(()=>{app.msnry.layout()},100):app.msnry.layout()})},initCredit(){let e=document.querySelector(".footer__credit");!e&&(document.body.classList.add("is-removed-credit"),(()=>{let e=`
      <div class="credits">
        <div class="credits__inner">
          <h2>This user has removed the credit link ðŸ¤¯</h2>
          <p>The theme was originally created by <a href="https://fukuo.tumblr.com/">fukuo</a> on Tumblr. You can browse other themes <a href="https://www.tumblr.com/themes/">here</a>.</p>
        </div>
      </div>
      `,t=document.body;t.insertAdjacentHTML("beforeend",e)})())},postNPFAudio(){let e=document.querySelectorAll(".posts");e.forEach((e,t)=>{let o=e.querySelectorAll("figcaption.audio-caption");o.forEach(e=>{e.parentElement.classList.add("tmblr-npf-audio"),e.parentElement.classList.remove("tmblr-full");let t=e.querySelector(".tmblr-audio-meta"),o=t?.querySelector(".title")?.textContent.trim(),r=t?.querySelector(".artist")?.textContent.trim(),a=t?.querySelector(".album")?.textContent.trim(),l=e?.querySelector(".album-cover")?.getAttribute("src");if(e.classList.add("d-none"),o||r||a||l){let s=document.createElement("section");s.className="posts__audio-npf";let i=document.createElement("div");if(i.className="posts__audio-npf__cover",l){let n=document.createElement("img");n.src=l,n.alt="",i.appendChild(n)}else{let d=document.createElement("div");d.className="album-placeholder",d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="5.5" cy="17.5" r="2.5"/><circle cx="17.5" cy="15.5" r="2.5"/><path d="M8 17V5l12-2v12"/></svg>',i.appendChild(d)}let p=document.createElement("div");p.className="posts__audio-npf__details",[{selector:".title",className:"posts__audio-npf__title",textContent:o},{selector:".artist",className:"posts__audio-npf__artist",textContent:r},{selector:".album",className:"posts__audio-npf__album",textContent:a},].forEach(({selector:e,className:t,textContent:o})=>{if(o){let r=document.createElement(e.startsWith(".")?"div":e);r.className=t,r.textContent=o,p.appendChild(r)}});let c=document.createElement("button");c.className="posts__audio-npf__button",c.innerHTML=`
            <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
          `;let u=e.parentElement.querySelector("audio");if(u&&(u.style.display="none",c.addEventListener("click",()=>{u.paused||u.ended?(u.play(),c.innerHTML=`
                  <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="6" y="4" width="4" height="16"></rect>
                    <rect x="14" y="4" width="4" height="16"></rect>
                  </svg>
                `):(u.pause(),c.innerHTML=`
                  <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                  </svg>
                `)}),u.addEventListener("play",()=>{c.innerHTML=`
                <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="6" y="4" width="4" height="16"></rect>
                  <rect x="14" y="4" width="4" height="16"></rect>
                </svg>
              `}),u.addEventListener("pause",()=>{c.innerHTML=`
                <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
              `}),u.addEventListener("ended",()=>{c.innerHTML=`
                <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
              `})),p.prepend(c),s.append(...[p,i]),e.parentElement.appendChild(s),u){let g=document.createElement("div");g.className="posts__audio-npf__progress-bar";let h=document.createElement("div");h.className="posts__audio-npf__progress-fill",g.appendChild(h),g.addEventListener("click",e=>{let t=g.getBoundingClientRect(),o=e.clientX-t.left,r=t.width;u.currentTime=u.duration*(o/r)}),u.addEventListener("timeupdate",()=>{let e=u.currentTime/u.duration*100;h.style.width=`${e}%`}),p.appendChild(g)}}})})},postNPFData(){document.querySelectorAll(".posts").forEach(e=>{let t=e.getAttribute("data-article-npf"),o=app.extractJSONString(t),r=app.decodeAndReplace(o);try{let a=JSON.parse(r);if(a.trail){let l=e.querySelectorAll(".reblog-list");l.forEach((e,t)=>{let o=a.trail[t];o?.layout.find(e=>"ask"===e.type);let r=o.blog,l=r.theme;r.tumblrmart_accessories;let s=r.tumblrmart_accessories?.badges,{description:i,title:n,name:d}=r,{link_color:p,title_font:c,title_color:u,background_color:g,header_image_scaled:h,avatar_shape:m}=l,y;if(r&&((y=document.createElement("div")).className="reblog-post-description d-none",y.innerHTML=`<div class="reblog-post-description__header" style="background-image:url(${h}); background-size:cover; background-position:center; min-height:135px;"></div>
                                  <img src="https://api.tumblr.com/v2/blog/${d}/avatar/64" alt="${d}" class="reblog-post-description__avatar ${m}">
                                  <h3 style="font-family:${c};">${n} (@${d})</h3> 
                                  <p>${i}</p>
                                 `,y.style.setProperty("--link-color",p),y.style.setProperty("--background-color",g),y.style.setProperty("--title-color",u),app.insertAfter(y,e.querySelector(".reblog-post-avatar"))),r.can_show_badges&&s){let _=e.querySelector(".reblog-post-badges");_||((_=document.createElement("span")).className="reblog-post-badges",app.insertAfter(_,e.querySelector(".reblog-post-avatar-name")));let f,$;s[0].urls.forEach((e,t)=>{(f=document.createElement("img")).src=e,($=document.createElement("span")).className="reblog-post-badges-item",$.append(f),_.append($),t>6&&_.classList.add("reblog-post-badges-huge")})}if(o.content)for(let v=0;v<o.content.length;v++){let w=o.content[v];switch(w.type){case"poll":let x=app.formatDate(w.created_at);app.convertEpochToRegularDate(w.timestamp);let k=app.convertEpochToRegularDate(w.timestamp+w.settings.expire_after),A=app.formatDate(k),S;(S=document.createElement("div")).className="poll-post-date",S.innerHTML=`<span class="poll-post-date__started"><b>Poll started on</b> ${x}</span>
                                                  <span class="poll-post-date__ended"><b>Poll ended on</b> ${A} </span>
                                                  `,e.querySelector(".poll-post").append(S);break;case"paywall":let E,L=w.text.replace("%s",`<strong>${d}</strong>`);(E=document.createElement("div")).className="reblog-list-paywall",E.innerHTML=`<h2 style="font-family:${c};">${w.title}</h2>
                                                        <p>${L}</p>
                                                        <p><a class="btn btn__secondary" href="${w.url}">Show your support!</a>
                                                       `,E.style.setProperty("--link-color",p),E.style.setProperty("--background-color",g),E.style.setProperty("--title-color",u),e.append(E),E.previousElementSibling.remove()}}})}}catch(s){console.error("Error parsing JSON:",s)}})},TOC(){let e=document.querySelectorAll(".posts");for(let t=0;t<e.length;t++)if(e[t].classList.contains("toc")){let o=document?.querySelector(".toc"),r=o?.querySelector(".posts__body"),a=r?.querySelectorAll("h2");r.insertAdjacentHTML("afterbegin",'<div class="posts__heading"><h1><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg> Table of contents</h1><ul></ul></div>');let l=document.querySelector(".posts__heading ul");for(heading of a)heading.id=`${heading.innerText.split(" ").join("-").toLowerCase()}`,l.insertAdjacentHTML("afterbegin",`<li><a href="#${heading.innerText.split(" ").join("-").toLowerCase()}">${heading.innerText}</a></li>`)}},sparkingEffect(){let e=function(){document.querySelectorAll(".sparkling").forEach(function(e){let o=e,r=o.querySelectorAll(".star");r.length>5&&r.forEach(function(e,t){0===t&&e.remove()}),o.insertAdjacentHTML("beforeend",t())}),setTimeout(e,Math.round(700*Math.random())+100)},t=function(){let e=Math.floor(20*Math.random())+10;return'<span class="star" style="top:'+(Math.floor(100*Math.random())-50)+"%; left:"+Math.floor(100*Math.random())+'%;"><svg width="'+e+'" height="'+e+'" viewBox="0 0 68 68" fill="none"><path d="M26.5 25.5C19.0043 33.3697 0 34 0 34C0 34 19.1013 35.3684 26.5 43.5C33.234 50.901 34 68 34 68C34 68 36.9884 50.7065 44.5 43.5C51.6431 36.647 68 34 68 34C68 34 51.6947 32.0939 44.5 25.5C36.5605 18.2235 34 0 34 0C34 0 33.6591 17.9837 26.5 25.5Z" fill="#FFC700" /></svg></span>'};e()},decodeAndReplace:e=>e.replace(/\\x22/g,'"').replace(/\\x3c/g,"<").replace(/\\x3e/g,">").replace(/\\x26amp;/g,"&").replace(/\\x26/g,"&").replace(/\\"/g,'"').replace(/\\'/g,"'").replace(/\\\\/g,"\\"),extractJSONString(e){let t=e.indexOf("'")+1,o=e.lastIndexOf("'");return e.substring(t,o)},insertAfter(e,t){t.parentNode.insertBefore(e,t.nextSibling)},formatDate(e){let[t,o]=e.split(" "),[r,a,l]=t.split("-").map(Number),[s,i,n]=o.split(":").map(Number),d=new Date(r,a-1,l,s,i,n);if(isNaN(d.getTime()))return console.error("Invalid Date:",e),"";let p=d.toLocaleString("en-US",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return p},convertEpochToRegularDate(e,t=!1){let o=new Date(1e3*e),r=o.toISOString().slice(0,19).replace("T"," ");return t?r+" GMT":r}};document.addEventListener("DOMContentLoaded",()=>{app.init()});